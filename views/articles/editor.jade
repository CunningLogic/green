extends ../layout

block stylesheets
  link(href="/javascripts/vender/qeditor/jquery.qeditor.css",rel="stylesheet")
  style.
   .container{
     max-width:990px;
   }
   .qeditor {
     background-color: #ffffff;
     border: 1px solid #cccccc;
     -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
     -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
     box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
     -webkit-transition: border linear .2s, box-shadow linear .2s;
     -moz-transition: border linear .2s, box-shadow linear .2s;
     -o-transition: border linear .2s, box-shadow linear .2s;
     transition: border linear .2s, box-shadow linear .2s;
     padding: 4px 6px;
     font-size: 14px;
     line-height: 20px;
     color: #555555;
     -webkit-border-radius: 4px;
     -moz-border-radius: 4px;
     border-radius: 4px;
     vertical-align: middle;
     outline: none;
     height: 400px;
   }

block content
 section.container
  h3 Q Editor
  form#article
   .form-group
     input#id.hidden(value='#{_id}')
   .form-group
     label slug:
     input.form-control(name="slug",type="text",value="#{slug}")
   .form-group
     label title:
     input.form-control(name="title",type="text",value="#{title}")
   .form-group
     textarea#editor(name='content',data-value="#{content}")
   .form-group
     label 分类:
     input.form-control(name="type",type="text",value="#{type}")
   .form-group
     label 标签：
     input.form-control(name="tags",type="text",value="#{tags}")
   .form-group
     label 作者:
     input.form-control(name="author",type="text",value="#{author}")
   .form-group
     label 创作时间:
     input.form-control(name="date",type="text",value="#{date}",placeholder="Format:YYYY-MM-DD")
   .form-group
     a#btn-submit.btn.btn-success.form-control(href="#") 提交文稿

block scripts
 script(src="/javascripts/vender/qeditor/jquery.qeditor.js")
 script(src="/javascripts/mui/api.js")
 script.
   var form=$('#article');
   $.api={};
   $.api.article={
     create:function(){
       var api={method:'post',url:'/api/user/articles'};
       return MUI.API.Factory({api:api},form);
     },
     edit:function(id){
       var api={method:'put',url:'/api/user/articles/'+id};
       return MUI.API.Factory({api:api},form);
     },
     query:function(){
     },
     all:function(){
     }
   };

   var _id=form.find('#id').val();
   var value=$("#editor").data('value');
       $("#editor").val(value)
   $("#editor").qeditor({});


   $("#btn-submit").click(function(e){
     if(!_id)
       $.api.article.create().submit();
     else
       $.api.article.edit(_id).submit();
     return false;
   });

